GTWR:
	Inherits: ^Defense
	Inherits@AUTOTARGET: ^AutoTargetforGTWR
    Inherits@EMPMechanic: ^EMPApplicableStructure
	Selectable:
		Bounds: 1024, 1024
	Valued:
		Cost: 500
	Tooltip:
		Name: Guard Tower
	Buildable:
		BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 1
		Prerequisites: infantryproduction, ~techlevel.3
		Queue: Defense.GDI, Defense.Nod, Defense.BossGDI
		Description: Basic defensive structure.\n\nStrong vs Infantry.\nWeak vs Tanks.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	WithBuildingBib:
		HasMinibib: true
	Armament:
		Weapon: TowerGun
		LocalOffset: 256,0,256
		MuzzleSequence: muzzle
        PauseOnCondition: build-incomplete
	AttackTurreted:
		PauseOnCondition: build-incomplete || emp-affected-structure
	BodyOrientation:
		QuantizedFacings: 8
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
        RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	WithMuzzleOverlay:
	Turreted:
		TurnSpeed: 512
	Power:
		Amount: -20
        RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: GTWR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

GUN:
	Inherits: ^Defense
	Inherits@AUTOTARGET: ^AutoTargetforGUN
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-BodyOrientation:
	Selectable:
		Bounds: 1024, 1024
	Valued:
		Cost: 500
	Tooltip:
		Name: Gun Turret
	Buildable:
		BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 2
		Prerequisites: vehicleproduction, ~!player.alliesc, ~techlevel.4
		Queue: Defense.GDI, Defense.Nod, Defense.Allies, Defense.BossGDI, Defense.BossAllies
		Description: Anti-Tank base defense.\n\nStrong vs Tanks, Vehicles.\nWeak vs Infantry.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	WithBuildingBib:
		HasMinibib: true
	Turreted:
		TurnSpeed: 18
		InitialFacing: 192
		RealignDelay: -1
		RequiresCondition: !build-incomplete
	WithSpriteTurret:
		RequiresCondition: !build-incomplete
		Recoils: false
	WithTurretAttackAnimation:
		Sequence: recoil
	Armament:
		Weapon: TurretGun
		LocalOffset: 512,0,112
		MuzzleSequence: muzzle
        PauseOnCondition: build-incomplete
	AttackTurreted:
		PauseOnCondition: build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	Power:
		Amount: -20
		RequiresCondition: !build-incomplete && !emp-affected-structure
	ClassicFacingBodyOrientation:
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: GUN.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

GUN2:
    Inherits: GUN
	Tooltip:
		Name: Heavy Turret
	Buildable:
		Prerequisites: vehicleproduction, ~player.alliesc, ~techlevel.4
		Queue: Defense.Allies
	Armament:
		Weapon: TurretGun2
		LocalOffset: 512,85,112, 512,-85,112
    RenderSprites:
        Image: gun2

HTUR:
	Inherits: ^Defense
	Inherits@AUTOTARGET: ^AutoTargetGround
	Inherits@shape: ^2x1Shape
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-BodyOrientation:
	Selectable:
		Bounds: 2048, 1024
		DecorationBounds: 1450, 1450, 0, -128
	Valued:
		Cost: 1500
	Tooltip:
		Name: Grand Turret
	Buildable:
		BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 12
		BuildLimit: 1
		Prerequisites: atek, ~player.alliesc, ~techlevel.6
		Queue: Defense.Allies
		Description: Maximum one can be built.\n\nArtillery base defense.\n\nStrong vs Tanks, Infantry.\nWeak vs fast Units.
	Building:
		Footprint: xx
		Dimensions: 2,1
	Health:
		HP: 60000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 8c0
	WithBuildingBib:
		HasMinibib: true
	Turreted:
		TurnSpeed: 12
		InitialFacing: 0
		RealignDelay: -1
		RequiresCondition: !build-incomplete
	WithSpriteTurret:
		RequiresCondition: !build-incomplete
		Recoils: false
	Armament:
		Weapon: HeavyTurretGun
		LocalOffset: 1000,200,60, 1000,0,60, 1000,-200,60
		MuzzleSequence: muzzle
        PauseOnCondition: build-incomplete
	AttackTurreted:
		PauseOnCondition: build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	Power:
		Amount: -60
		RequiresCondition: !build-incomplete && !emp-affected-structure
	ClassicFacingBodyOrientation:
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: HTUR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished
	ReloadArmamentsBar:
		Armaments: primary
		Color: FFFF00

ATWR:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetAll
    Inherits@EMPMechanic: ^EMPApplicableStructure    
	-RenderRangeCircle:
	Valued:
		Cost: 1000
	Tooltip:
		Name: Advanced Guard Tower
	Buildable:
		BuildDuration: 1500
        BuildDurationModifier: 100
		BuildPaletteOrder: 5
		Prerequisites: miss, ~techlevel.6
		Queue: Defense.GDI, Defense.BossGDI
		Description: All-purpose defensive structure.\nRequires power to operate.\n\nCan attack Aircraft.\nStrong vs Aircraft, Vehicles.\nWeak vs Tanks.
	Selectable:
		Bounds: 1024, 1024
		DecorationBounds: 938, 2048, 0, -512
	Health:
		HP: 60000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 8c0
	WithRangeCircle@1:
		Range: 7c0
		Color: FFFF0080
        RequiresCondition: !rank-veteran && !rank-elite
	WithRangeCircle@2:
		Range: 8c750
		Color: FFFF0080
        RequiresCondition: rank-veteran
	WithRangeCircle@3:
		Range: 10c500
		Color: FFFF0080
        RequiresCondition: rank-elite
	WithBuildingBib:
		HasMinibib: true
	Turreted:
		TurnSpeed: 512
		Offset: 128,128,384
	Armament@PRIMARY:
        Name: primary
		Weapon: TowerMissileAG
		LocalOffset: 256,128,0, 256,-128,0
		LocalYaw: -100,100
		PauseOnCondition: build-incomplete || reload-air || lowpower
        ReloadingCondition: reload-ground
        RequiresCondition: !owner.is.gdib
	Armament@SECONDARY:
        Name: secondary
		Weapon: TowerMissileAA
		LocalOffset: 256,128,0, 256,-128,0
		LocalYaw: -100,100
		PauseOnCondition: build-incomplete || reload-ground || lowpower
        ReloadingCondition: reload-air
        RequiresCondition: !owner.is.gdib
	Armament@TERTIARY:
        Name: tertiary
		Weapon: TowerMissileAGEMP
		LocalOffset: 256,128,0, 256,-128,0
		LocalYaw: -100,100
		PauseOnCondition: build-incomplete || reload-air || lowpower
        ReloadingCondition: reload-ground
        RequiresCondition: owner.is.gdib
	Armament@QUARTENARY:
        Name: quartenary
		Weapon: TowerMissileAAEMP
		LocalOffset: 256,128,0, 256,-128,0
		LocalYaw: -100,100
		PauseOnCondition: build-incomplete || reload-ground || lowpower
        ReloadingCondition: reload-air
        RequiresCondition: owner.is.gdib
    GrantConditionOnFaction@gdib:
		Condition: owner.is.gdib
		Factions: gdib
		ResetOnOwnerChange: True
    AttackTurreted:
        Armaments: primary, secondary, tertiary, quartenary
        PauseOnCondition: build-incomplete || lowpower || emp-affected-structure
	BodyOrientation:
		QuantizedFacings: 8
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	Power:
		Amount: -60
		RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
    WithColoredOverlay@IDISABLE:
        RequiresCondition: lowpower && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary, secondary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: ATWR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

OBLI:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetGround
    Inherits@EMPMechanic: ^EMPApplicableStructure
	Valued:
		Cost: 1500
	Tooltip:
		Name: Obelisk of Light
	Buildable:
		BuildDuration: 2700
        BuildDurationModifier: 100
		BuildPaletteOrder: 5
		Prerequisites: anytier3, ~techlevel.6
		Queue: Defense.Nod, Defense.BossNod
		Description: Advanced base defense.\nRequires power to operate.\n\nStrong vs all Ground units.
	Selectable:
		Bounds: 1024, 1024
		DecorationBounds: 938, 1877, 0, -426
	Health:
		HP: 75000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 8c0
	WithBuildingBib:
		HasMinibib: true
	-WithSpriteBody:
	WithChargeSpriteBody:
		Sequence: active
	Armament:
		Weapon: Laser
		LocalOffset: 0,-85,1280
        PauseOnCondition: build-incomplete
	AttackCharges:
		PauseOnCondition: lowpower || build-incomplete || emp-affected-structure
		ChargeLevel: 50
		ChargingCondition: charging
	AmbientSound:
		RequiresCondition: charging
		SoundFiles: obelpowr.aud
		Interval: 30, 40
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && emp-affected-structure
	Power:
		Amount: -75
		RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
    WithColoredOverlay@IDISABLE:
        RequiresCondition: lowpower && !emp-affected-structure
	WithChargeOverlay@BUILDUP:
		Sequence: active-lights
		PauseOnCondition: lowpower
		RequiresCondition: !build-incomplete
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: OBLI.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

LTUR:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetGround
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-BodyOrientation:
	Selectable:
		Bounds: 1024, 1024
	Valued:
		Cost: 600
	Tooltip:
		Name: Laser Turret
	Buildable:
        BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 2
		Prerequisites: vehicleproduction, ~techlevel.4
		Queue: Defense.BossNod
		Description: All-purpose base defense.\nRequires power to operate.\n\nStrong vs all Ground units.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	WithBuildingBib:
		HasMinibib: true
	Turreted:
		TurnSpeed: 18
		InitialFacing: 128
		RealignDelay: -1
		RequiresCondition: !build-incomplete
	WithSpriteTurret:
		RequiresCondition: !build-incomplete
		Recoils: false
	Armament:
		Weapon: TurretLaser
        LocalOffset: 512,0,189
        PauseOnCondition: build-incomplete
	AttackTurreted:
		PauseOnCondition: lowpower || build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	Power:
		Amount: -20
		RequiresCondition: !build-incomplete && !emp-affected-structure
	ClassicFacingBodyOrientation:
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
    WithColoredOverlay@IDISABLE:
        RequiresCondition: lowpower && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: LTUR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

SAM:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetAir
	Inherits@shape: ^2x1Shape
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-WithSpriteBody:
	-RenderDetectionCircle:
	-BodyOrientation:
	-ActorPreviewPlaceBuildingPreview:
    -ExternalCondition@CloakingField:
    -Cloak@CloakingField:
	Selectable:
		Bounds: 2048, 1024
	HitShape:
		Type: Rectangle
			TopLeft: -768,-512
			BottomRight: 768,512
	Valued:
		Cost: 750
	Tooltip:
		Name: SAM Site
	Buildable:
        BuildDuration: 1200
        BuildDurationModifier: 100
		BuildPaletteOrder: 6
		Prerequisites: anyhq, ~techlevel.6
		Queue: Defense.Nod, Defense.BossNod
		Description: Cloaked Anti-Aircraft base defense.\nRequires power to operate.\n\nCan attack only Aircraft.
	Building:
		Footprint: xx
		Dimensions: 2,1
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 3c512
    RevealsShroudMultiplier@Shooting:
        Modifier: 200
        RequiresCondition: is-shooting && !emp-affected-structure
	Turreted:
		TurnSpeed: 24
		InitialFacing: 0
		RealignDelay: -1
	WithEmbeddedTurretSpriteBody:
		QuantizedFacings: 32
	Armament:
        Name: primary
		Weapon: SAMMissile
		MuzzleSequence: muzzle
		PauseOnCondition: !ammo || build-incomplete || lowpower || emp-affected-structure
	AmmoPool:
		Armaments: primary
		Ammo: 6
		AmmoCondition: ammo
		ReloadDelay: 15
	WithAmmoPipsDecoration:
		Position: BottomLeft
		Margin: 4, 3
		PipCount: 3
		RequiresSelection: true
	ReloadAmmoPool:
		Delay: 60
		Count: 6
		RequiresCondition: !ammo && !emp-affected-structure
	AttackPopupTurreted:
        ClosedDamageMultiplier: 50
		PauseOnCondition: lowpower || build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	RenderRangeCircle:
		RangeCircleType: aa
	Power:
		Amount: -30
		RequiresCondition: !build-incomplete && !emp-affected-structure
	ClassicFacingBodyOrientation:
	SequencePlaceBuildingPreview:
		Sequence: place
		SequenceAlpha: 0.65
	Cloak:
        CloakType: Underground
        DetectionTypes: Underground
		InitialDelay: 125
		CloakDelay: 75
		Palette: cloaktransparent
		IsPlayerPalette: true
		UncloakSound: appear1.aud
		PauseOnCondition: cloak-force-disabled || build-incomplete || is-shooting || lowpower || emp-affected-structure
	GrantConditionOnDamageState@UNCLOAK:
		Condition: cloak-force-disabled
		ValidDamageStates: Critical
	GrantConditionOnAttack@UNCLOAK:
		Condition: is-shooting
		ArmamentNames: primary
		RevokeDelay: 75
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	SpawnActorOnDeath@HUSK:
		Actor: SAM.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

SAM2:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetAir
	Inherits@shape: ^2x1Shape
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-RenderDetectionCircle:
	-ActorPreviewPlaceBuildingPreview:
	-BodyOrientation:
    ClassicFacingBodyOrientation:
	Selectable:
		Bounds: 2048, 1024
	HitShape:
		Type: Rectangle
			TopLeft: -768,-512
			BottomRight: 768,512
	Valued:
		Cost: 750
	Tooltip:
		Name: SAM Site
	Buildable:
        BuildDuration: 1200
        BuildDurationModifier: 100
		BuildPaletteOrder: 6
		Prerequisites: anyhq, ~techlevel.6
		Queue: Defense.Soviet, Defense.BossSoviet
		Description: Anti-Aircraft base defense.\nRequires power to operate.\n\nCan attack only Aircraft.
	Building:
		Footprint: xx
		Dimensions: 2,1
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 3c512
    RevealsShroudMultiplier@Shooting:
        Modifier: 200
        RequiresCondition: is-shooting && !emp-affected-structure
	GrantConditionOnAttack@ShootingVision:
		Condition: is-shooting
		ArmamentNames: primary
		RevokeDelay: 75
	WithBuildingBib:
        HasMinibib: true
	Turreted:
		TurnSpeed: 24
		InitialFacing: 0
		RealignDelay: -1
	WithSpriteTurret:
		RequiresCondition: !build-incomplete
		Recoils: false
	Armament:
        Name: primary
		Weapon: SAMMissile
		MuzzleSequence: muzzle
        PauseOnCondition: !ammo || build-incomplete || lowpower || emp-affected-structure
	AmmoPool:
		Armaments: primary
		Ammo: 6
		AmmoCondition: ammo
		ReloadDelay: 15
	WithAmmoPipsDecoration:
		Position: BottomLeft
		Margin: 4, 3
		PipCount: 3
		RequiresSelection: true
	ReloadAmmoPool:
		Delay: 60
		Count: 6
        RequiresCondition: !ammo && !emp-affected-structure
	AttackTurreted:
        PauseOnCondition: lowpower || build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	RenderRangeCircle:
		RangeCircleType: aa
	Power:
		Amount: -30
		RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	SequencePlaceBuildingPreview:
		Sequence: place
		SequenceAlpha: 0.65
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: SAM2.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

FTWR:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetGround
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-QuantizeFacingsFromSequence:
	BodyOrientation:
		QuantizedFacings: 8
	Valued:
		Cost: 600
	Tooltip:
		Name: Flame Tower
	Buildable:
        BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 2
		Prerequisites: vehicleproduction, ~!player.sovieta, ~techlevel.4
		Queue: Defense.Soviet, Defense.BossSoviet
		Description: General-purpose base defense.\nRequires power to operate.\n\nStrong vs Infantry, Light Vehicles.\nWeak vs Tanks.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	WithBuildingBib:
		HasMinibib: true
	Turreted:
		TurnSpeed: 512
		Offset: 0,0,112
	Armament:
		Weapon: FireballLauncher
		LocalOffset: 512,0,0
		PauseOnCondition: build-incomplete || lowpower
	AttackTurreted:
		PauseOnCondition: build-incomplete || lowpower || emp-affected-structure
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	Power:
		Amount: -20
        RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: FTWR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

CTUR:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetAir
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-WithSpriteBody:
	-RenderDetectionCircle:
	-BodyOrientation:
	-ActorPreviewPlaceBuildingPreview:
    -ExternalCondition@CloakingField:
    -Cloak@CloakingField:
	Valued:
		Cost: 600
	Tooltip:
		Name: Chemical Turret
	Buildable:
        BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 1
		Prerequisites: vehicleproduction, ~techlevel.3
		Queue: Defense.BossNod
		Description: Cloaked Anti-Infantry base defense.\n\nStrong vs Infantry.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
    RevealsShroudMultiplier@Underground:
        Modifier: 50
        RequiresCondition: !( is-shooting || emp-affected-structure )
	Turreted:
		TurnSpeed: 512
		Offset: 0,0,112
		InitialFacing: 0
		RealignDelay: -1
	WithEmbeddedTurretSpriteBody:
		QuantizedFacings: 8
	Armament:
        Name: primary
		Weapon: BigChemSpray
        LocalOffset: 512,128,42, 512,-128,42
		FireDelay: 3
		MuzzleSequence: muzzle
		PauseOnCondition: build-incomplete || lowpower || emp-affected-structure
	AttackPopupTurreted:
        ClosedDamageMultiplier: 50
		PauseOnCondition: lowpower || build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	Power:
		Amount: -20
		RequiresCondition: !build-incomplete && !emp-affected-structure
	ClassicFacingBodyOrientation:
	SequencePlaceBuildingPreview:
		Sequence: place
		SequenceAlpha: 0.65
	Cloak:
        CloakType: Underground
        DetectionTypes: Underground
		InitialDelay: 125
		CloakDelay: 75
		Palette: cloaktransparent
		IsPlayerPalette: true
		UncloakSound: appear1.aud
		PauseOnCondition: cloak-force-disabled || build-incomplete || is-shooting || lowpower || emp-affected-structure
	GrantConditionOnDamageState@UNCLOAK:
		Condition: cloak-force-disabled
		ValidDamageStates: Critical
	GrantConditionOnAttack@UNCLOAK:
		Condition: is-shooting
		ArmamentNames: primary
		RevokeDelay: 75
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	SpawnActorOnDeath@HUSK:
		Actor: CTUR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

TSLA:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetGround
	Selectable:
		Bounds: 1024, 1024
		DecorationBounds: 1024, 1706, 0, -341
	Valued:
		Cost: 1200
	Tooltip:
		Name: Tesla Coil
	Buildable:
        BuildDuration: 1200
        BuildDurationModifier: 100
		BuildPaletteOrder: 5
		Prerequisites: anyhq, ~!player.sovietb, ~!player.sovietc, ~techlevel.5
		Queue: Defense.Soviet, Defense.BossSoviet
		Description: Advanced base defense.\nRequires power to operate.\n\nSpecial: Electromagnetic\nAttacks briefly short-circuit\nenemy Vehicles and Defenses.\n\nStrong vs Vehicles, Infantry.\nWeak vs Aircraft, Artillery.
	Health:
		HP: 60000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 8c0
	WithBuildingBib:
		HasMinibib: true
	WithTeslaChargeAnimation:
	Armament:
		Weapon: TeslaZap
		LocalOffset: 0,0,896
        PauseOnCondition: build-incomplete
	AttackTesla:
		RequiresCondition: !build-incomplete
		PauseOnCondition: lowpower || build-incomplete
		ChargeAudio: tslachg2.aud
		MaxCharges: 3
		ReloadDelay: 120
	Power:
		Amount: -100
        RequiresCondition: !build-incomplete
    PowerMultiplier@sovieta:
        Modifier: 80
        RequiresCondition: owner.is.sovieta
	GrantConditionOnFaction@sovieta:
		Condition: owner.is.sovieta
		Factions: sovieta
		ResetOnOwnerChange: True
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete
	WithRangeCircle:
	Targetable@ChargeTargeting:
		TargetTypes: Charge
		RequiresCondition: TeslaChargeable && !haspower
	GrantCondition@Overcharge:
		Condition: TeslaHasCharge
		RequiresCondition: TeslaChargeApplied
	TimedConditionBar@Charged:
		Condition: TeslaChargeApplied
		Color: f4f442
	GrantCondition@ChargeTargeting:
		Condition: TeslaChargeable
		RequiresCondition: ( lowpower || TeslaHasCharge )
	ExternalCondition@Overcharge:
        Condition: TeslaChargeApplied
	WithDecoration@Overcharge:
		Image: poweroff
		Sequence: offline
		Position: BottomRight
		RequiresCondition: TeslaChargeApplied
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
		RequiresCondition: !TeslaHasCharge
	GrantConditionOnPowerState@HASPOWER:
		Condition: haspower
		ValidPowerStates: Normal
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: TSLA.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

GAP:
	Inherits: ^BaseBuilding
	Inherits@IDISABLE: ^DisabledOverlay
    Inherits@EMPMechanic: ^EMPApplicableStructure
	Valued:
		Cost: 900
	Tooltip:
		Name: Gap Generator
	Buildable:
        BuildDuration: 1500
        BuildDurationModifier: 100
		BuildPaletteOrder: 13
		Queue: Building.Allies, Building.BossAllies
		Prerequisites: atek, ~!player.alliesa, ~!player.alliesb, ~techlevel.7
		Description: Obscures the enemy's view with shroud.\nCan be toggled on/off via deploy command.\nRequires power to operate.
	Selectable:
		Bounds: 1024, 1024
		DecorationBounds: 1024, 2048, 0, -512
	SelectionDecorations:
	WithSpriteBody:
		PauseOnCondition: lowpower || deployed || emp-affected-structure
	Health:
		HP: 60000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 8c0
	CreatesShroud:
		Range: 9c0
		RequiresCondition: !lowpower && !deployed && !emp-affected-structure
	WithRangeCircle@Normal:
		Color: 008B8B
		Width: 1
		BorderColor: 000000
		BorderWidth: 3
		Range: 9c0
		RequiresCondition: !deployed && !emp-affected-structure
	GrantConditionOnDeploy:
		PauseOnCondition: emp-affected-structure
		DeployedCondition: deployed
		SkipMakeAnimation: true
        DeployCursor: powerdown
        DeployBlockedCursor: powerdown-blocked
	WithDecoration@offline:
		RequiresSelection: false
		Image: pips
		Sequence: tag-hold
		Position: Top
		Margin: 0, 4
		RequiresCondition: deployed
	Power:
		Amount: -80
        RequiresCondition: !build-incomplete && !deployed && !emp-affected-structure
	MustBeDestroyed:
		RequiredForShortGame: false
	HitShape:
		Type: Rectangle
			TopLeft: -512, -512
			BottomRight: 512, 512
	WithBuildingBib:
        HasMinibib: true
	RenderSprites:
		Image: GAP
	ActorPreviewPlaceBuildingPreview:
		Animated: false
    WithColoredOverlay@IDISABLE:
        RequiresCondition: lowpower && !emp-affected-structure
	ProximityExternalCondition@GAPGenerator:
		Condition: within-gap-radius
		ValidRelationships: Enemy, Neutral
		Range: 9c0
        RequiresCondition: !deployed && !emp-affected-structure
    -CaptureManager:
    -Capturable:
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished
	SpawnActorOnDeath@HUSK:
		Actor: GAP.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

GAP.Clone:
    Inherits: GAP
	Buildable:
		Queue: Defense.Allies, Defense.BossAllies
	RenderSprites:
		Image: gap
    -MapEditorData:

AGUN:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetAir
    Inherits@EMPMechanic: ^EMPApplicableStructure
    -BodyOrientation:
    ClassicFacingBodyOrientation:
    -RenderDetectionCircle:
	Selectable:
		Bounds: 1024, 1024
		DecorationBounds: 1024, 1365, 0, -170
	Valued:
		Cost: 600
	Tooltip:
		Name: Anti-Air Gun
	Buildable:
        BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 6
		Prerequisites: anyhq, ~techlevel.6
		Queue: Defense.Allies, Defense.BossAllies
		Description: Anti-Air base defense.\nRequires power to operate.\n\nCan attack only Aircraft.
    Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 3c512
    RevealsShroudMultiplier@Shooting:
        Modifier: 200
        RequiresCondition: is-shooting && !emp-affected-structure
	GrantConditionOnAttack@ShootingVision:
		Condition: is-shooting
		ArmamentNames: primary
		RevokeDelay: 75
	Turreted:
		TurnSpeed: 24
		InitialFacing: 820
	WithSpriteTurret:
		RequiresCondition: !build-incomplete
		Recoils: false
	WithTurretAttackAnimation:
        Armament: primary
        Turret: primary
		Sequence: recoil
	Armament:
        Name: primary
		Weapon: FlakGun
		LocalOffset: 520,100,450, 520,-150,450
		MuzzleSequence: muzzle
        PauseOnCondition: !ammo
	AmmoPool:
		Armaments: primary
		Ammo: 10
		AmmoCondition: ammo
		ReloadDelay: 15
	WithAmmoPipsDecoration:
		Position: BottomLeft
		Margin: 4, 3
		PipCount: 5
		RequiresSelection: true
	ReloadAmmoPool:
		Delay: 50
		Count: 10
		RequiresCondition: !ammo && !emp-affected-structure
	AttackTurreted:
		PauseOnCondition: lowpower || build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	RenderRangeCircle:
		RangeCircleType: aa
	Power:
		Amount: -45
        RequiresCondition: !build-incomplete && !emp-affected-structure
	WithBuildingBib:
        HasMinibib: true
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: AGUN.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

SBAG:
	Inherits: ^Wall
    Inherits@productionboost: ^ProductionBoost
	Valued:
		Cost: 50
	CustomSellValue:
		Value: 0
	Tooltip:
		Name: Sandbag Barrier
	Buildable:
        BuildDuration: 75
        BuildDurationModifier: 100
		BuildPaletteOrder: 7
		Prerequisites: infantryproduction, ~techlevel.2
		Queue: Defense.GDI, Defense.Allies, Defense.BossGDI, Defense.BossAllies
		Description: Stops infantry and light vehicles.\nCan be crushed by tanks.
	Armor:
		Type: Light
	LineBuild:
		NodeTypes: sandbag
	LineBuildNode:
		Types: sandbag
	WithWallSpriteBody:
		Type: sandbag

BARB:
	Inherits: ^Wall
    Inherits@productionboost: ^ProductionBoost
	Valued:
		Cost: 50
	CustomSellValue:
		Value: 0
	Tooltip:
		Name: Barbed Wire
	Buildable:
        BuildDuration: 75
        BuildDurationModifier: 100
		BuildPaletteOrder: 7
		Prerequisites: infantryproduction, ~techlevel.2
		Queue: Defense.Nod, Defense.BossNod
		Description: Stops infantry and light vehicles.\nCan be crushed by tanks.
	Armor:
		Type: Light
	LineBuild:
		NodeTypes: barbwire
	LineBuildNode:
		Types: barbwire
	WithWallSpriteBody:
		Type: barbwire

CYCL:
	Inherits: ^Wall
    Inherits@productionboost: ^ProductionBoost
	Valued:
		Cost: 75
	CustomSellValue:
		Value: 0
	Tooltip:
		Name: Chain Link Barrier
	Buildable:
        BuildDuration: 125
        BuildDurationModifier: 100
		BuildPaletteOrder: 8
		Prerequisites: vehicleproduction, ~techlevel.4
		Queue: Defense.GDI, Defense.Nod, Defense.Allies, Defense.Soviet, Defense.BossGDI, Defense.BossNod, Defense.BossAllies, Defense.BossSoviet
		Description: Stops infantry and light vehicles.\nBlocks projectiles.\nCan be crushed by tanks.
	Armor:
		Type: Aluminium
	BlocksProjectiles:
	LineBuild:
		NodeTypes: chain
	LineBuildNode:
		Types: chain
	WithWallSpriteBody:
		Type: chain

BRIK:
	Inherits: ^Wall
    Inherits@productionboost: ^ProductionBoost
	Valued:
		Cost: 100
	CustomSellValue:
		Value: 0
	Tooltip:
		Name: Concrete Barrier
	Buildable:
        BuildDuration: 175
        BuildDurationModifier: 100
		BuildPaletteOrder: 9
		Prerequisites: anytier3, ~techlevel.6
		Queue: Defense.GDI, Defense.Nod, Defense.Allies, Defense.Soviet, Defense.BossGDI, Defense.BossNod, Defense.BossAllies, Defense.BossSoviet
		Description: Stops infantry and vehicles.\nBlocks projectiles.
	Health:
		HP: 20000
	Armor:
		Type: Concrete
	BlocksProjectiles:
	LineBuild:
		NodeTypes: concrete, gate
	LineBuildNode:
		Types: concrete
	WithWallSpriteBody:
		Type: concrete
	Replaceable:
		Types: Gate
	-Crushable:
    DamageMultiplier:
        Modifier: 50
        RequiresCondition: owner.is.alliesc
	GrantConditionOnFaction@alliesc:
		Condition: owner.is.alliesc
		Factions: alliesc
		ResetOnOwnerChange: False

WOOD:
	Inherits: ^Wall
	Armor:
		Type: Wood
	Tooltip:
		Name: Wooden Fence
	LineBuild:
		NodeTypes: woodfence
	LineBuildNode:
		Types: woodfence
	WithWallSpriteBody:
		Type: woodfence

FENC:
	Inherits: ^Wall
    Inherits@productionboost: ^ProductionBoost
	Valued:
		Cost: 50
	CustomSellValue:
		Value: 0
	Tooltip:
		Name: Wire Fence
	Buildable:
        BuildDuration: 75
        BuildDurationModifier: 100
		BuildPaletteOrder: 7
		Prerequisites: infantryproduction, ~techlevel.2
		Queue: Defense.Soviet, Defense.BossSoviet
		Description: Stops infantry and light vehicles.\nCan be crushed by tanks.
	Armor:
		Type: Light
	LineBuild:
		NodeTypes: fenc
	LineBuildNode:
		Types: fenc
	WithWallSpriteBody:
		Type: fenc

HGAT:
	Inherits: ^Gate
    Inherits@productionboost: ^ProductionBoost
    Inherits@EMPMechanic: ^EMPApplicableStructure
	HitShape:
		UseTargetableCellsOffsets: true
		Type: Rectangle
            TopLeft: -1536, -512
            BottomRight: 1536, 512
	Building:
		Footprint: xxx
		Dimensions: 3,1
	Buildable:
        BuildDuration: 175
        BuildDurationModifier: 100
		BuildPaletteOrder: 10
		Prerequisites: anytier3, ~techlevel.6
        Queue: Defense.GDI, Defense.Nod, Defense.Allies, Defense.Soviet, Defense.BossGDI, Defense.BossNod, Defense.BossAllies, Defense.BossSoviet
		Description: Places a gate that blocks enemy access into your base.\n\nYou can rotate using Rotate Building hotkey (default: V)
	Valued:
		Cost: 100
	Demolishable:
		Condition: being-demolished
	Sellable:
		RequiresCondition: !being-demolished && !emp-affected-structure
	CustomSellValue:
		Value: 50
	WithGateSpriteBody:
        PauseOnCondition: lowpower || emp-affected-structure
		WallConnections: -1,0, 3,0
        Type: concrete
	Gate:
		PauseOnCondition: lowpower || emp-affected-structure
	LineBuildNode:
		Connections: -1,0, 1,0
	Tooltip:
		Name: Gate
	RevealsShroud:
		Range: 1c0
	RenderSprites:
		Image: hgat
		FactionImages:
			gdi: hgat-gdi
            gdia: hgat-gdi
            gdib: hgat-gdi
            gdic: hgat-gdi
            bossgdi: hgat-gdi
			nod: hgat-nod
            noda: hgat-nod
            nodb: hgat-nod
            nodc: hgat-nod
            bossnod: hgat-nod
            allies: hgat-allies
            alliesa: hgat-allies
            alliesb: hgat-allies
            alliesc: hgat-allies
            bossallies: hgat-allies
            soviet: hgat-soviet
            sovieta: hgat-soviet
            sovietb: hgat-soviet
            sovietc: hgat-soviet
            bosssoviet: hgat-soviet
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	PlaceBuildingVariants:
        Actors: vgat
        Facings: 128
	Replacement:
		ReplaceableTypes: Gate
    DamageMultiplier:
        Modifier: 50
        RequiresCondition: owner.is.alliesc
	GrantConditionOnFaction@alliesc:
		Condition: owner.is.alliesc
		Factions: alliesc
		ResetOnOwnerChange: False

VGAT:
	Inherits: ^Gate
    Inherits@productionboost: ^ProductionBoost
    Inherits@EMPMechanic: ^EMPApplicableStructure
	HitShape:
		UseTargetableCellsOffsets: true
		Type: Rectangle
			TopLeft: -512, -1536
			BottomRight: 512, 1536
	Building:
		Footprint: x x x
		Dimensions: 1,3
	Buildable:
        BuildDuration: 175
        BuildDurationModifier: 100
		BuildPaletteOrder: 11
		Prerequisites: ~disabled
		Queue: Defense.GDI, Defense.Nod, Defense.Soviet, Defense.Allies, Defense.BossGDI, Defense.BossNod, Defense.BossSoviet, Defense.BossAllies
		Description: Places an vertical gate.\nBlocks enemy access into your base.
	Valued:
		Cost: 100
	Demolishable:
		Condition: being-demolished
	Sellable:
		RequiresCondition: !being-demolished && !emp-affected-structure
	CustomSellValue:
		Value: 50
	Gate:
		PauseOnCondition: lowpower || emp-affected-structure
	WithGateSpriteBody:
        PauseOnCondition: lowpower || emp-affected-structure
		WallConnections: 0,-1, 0,3
        Type: concrete
	LineBuildNode:
		Connections: 0,-1, 0,1
	Tooltip:
		Name: Gate
	RevealsShroud:
		Range: 1c0
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	Replacement:
		ReplaceableTypes: Gate
    DamageMultiplier:
        Modifier: 50
        RequiresCondition: owner.is.alliesc
	GrantConditionOnFaction@alliesc:
		Condition: owner.is.alliesc
		Factions: alliesc
		ResetOnOwnerChange: False

PBOX:
	Inherits: ^Defense
	Inherits@AUTOTARGET: ^AutoTargetGround
    Inherits@EMPMechanic: ^EMPApplicableStructure
    Inherits@TRANSPORT: ^Transport
	Selectable:
		Bounds: 1024, 1024
	Valued:
		Cost: 500
	CustomSellValue:
		Value: 400
	Tooltip:
		Name: Pillbox
	Buildable:
        BuildDuration: 600
        BuildDurationModifier: 100
		BuildPaletteOrder: 2
		Prerequisites: infantryproduction, ~techlevel.3
		Queue: Defense.Allies, Defense.BossAllies
		Description: Static defense with\na heavy machine gun.\n\nCan shelter one Infantry.\nCannot attack without inhabitant.\nComes with a initial inhabitant.\n\nStrong vs Infantry.\nWeak vs Tanks.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	WithBuildingBib:
        HasMinibib: true
	Cargo:
        LoadedCondition: loaded
		Types: Infantry
		MaxWeight: 1
		InitialUnits: e1
		PassengerConditions:
			rmbo: commandoinside
            tany: commandoinside
            volk: commandoinside
            mega: commandoinside
            snip: sniperinside
	WithDecoration@COMMANDOSKULL:
		Image: pips
		Sequence: pip-skull
		Palette: effect
		Position: TopLeft
		ValidRelationships: Ally
		RequiresCondition: commandoinside
	WithDecoration@CROSSHAIR:
		Image: pips
		Sequence: pip-sniper
		Palette: effect
		Position: TopLeft
		ValidRelationships: Ally
		RequiresCondition: sniperinside
	Armament@PRIMARY:
        Name: primary
		Weapon: PillboxGun
		MuzzleSequence: muzzle
		LocalOffset: 448,0,0
        PauseOnCondition: build-incomplete || !loaded
        RequiresCondition: !sniperinside
    Armament@SECONDARY:
        Name: secondary
        Weapon: PillboxSniper
 		MuzzleSequence: muzzle
		LocalOffset: 448,0,0       
        PauseOnCondition: build-incomplete || !loaded
        RequiresCondition: sniperinside
	AttackTurreted:
        Armaments: primary, secondary
		PauseOnCondition: build-incomplete || emp-affected-structure
	BodyOrientation:
		QuantizedFacings: 8
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
        RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure && loaded
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	WithMuzzleOverlay:
	Turreted:
		TurnSpeed: 512
		Offset: 0,0,64
	Power:
		Amount: -15
        RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RefundPercent: 100
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary, secondary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: PBOX.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

HBOX:
	Inherits: ^Defense
	Inherits@AUTOTARGET: ^AutoTargetGround
    Inherits@EMPMechanic: ^EMPApplicableStructure
    Inherits@TRANSPORT: ^Transport
	Selectable:
		Bounds: 1024, 1024
	Valued:
		Cost: 700
	CustomSellValue:
		Value: 600
	Tooltip:
		Name: Camo Pillbox
	Buildable:
		BuildDuration: 900
        BuildDurationModifier: 100
		BuildPaletteOrder: 5
		Prerequisites: anyhq, ~techlevel.5
		Queue: Defense.Allies, Defense.BossAllies
		Description: Camouflaged static defense with\na heavy machine gun.\n\nCan shelter one Infantry.\nCannot attack without inhabitant.\nComes with a initial inhabitant.\n\nStrong vs Infantry.\nWeak vs Tanks.
	Building:
	Health:
		HP: 40000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	Cargo:
        LoadedCondition: loaded
		Types: Infantry
		MaxWeight: 1
		InitialUnits: e1
		PassengerConditions:
			rmbo: commandoinside
            tany: commandoinside
            volk: commandoinside
            mega: commandoinside
            snip: sniperinside
	WithDecoration@COMMANDOSKULL:
		Image: pips
		Sequence: pip-skull
		Palette: effect
		Position: TopLeft
		ValidRelationships: Ally
		RequiresCondition: commandoinside
	WithDecoration@CROSSHAIR:
		Image: pips
		Sequence: pip-sniper
		Palette: effect
		Position: TopLeft
		ValidRelationships: Ally
		RequiresCondition: sniperinside
	Armament@PRIMARY:
        Name: primary
		Weapon: PillboxGun
		MuzzleSequence: muzzle
		LocalOffset: 448,0,0
        PauseOnCondition: build-incomplete || !loaded
        RequiresCondition: !sniperinside
    Armament@SECONDARY:
        Name: secondary
        Weapon: PillboxSniper
 		MuzzleSequence: muzzle
		LocalOffset: 448,0,0
        PauseOnCondition: build-incomplete || !loaded
        RequiresCondition: sniperinside
	AttackTurreted:
        Armaments: primary, secondary
		PauseOnCondition: build-incomplete || emp-affected-structure || !loaded
	BodyOrientation:
		QuantizedFacings: 8
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
        RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure && loaded
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	WithMuzzleOverlay:
	Turreted:
		TurnSpeed: 512
		Offset: 0,0,64
	Power:
		Amount: -15
        RequiresCondition: !build-incomplete && !emp-affected-structure
    Sellable:
        RefundPercent: 100
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	Cloak:
        CloakType: Underground
        DetectionTypes: Underground
		InitialDelay: 125
		CloakDelay: 75
		Palette: cloaktransparent
		IsPlayerPalette: true
        UncloakSound: appear1.aud
		PauseOnCondition: cloak-force-disabled || build-incomplete || is-shooting || lowpower || emp-affected-structure
	GrantConditionOnDamageState@UNCLOAK:
		Condition: cloak-force-disabled
		ValidDamageStates: Critical
	GrantConditionOnAttack@UNCLOAK:
		Condition: is-shooting
		ArmamentNames: primary
		RevokeDelay: 75
	SpawnActorOnDeath@HUSK:
		Actor: HBOX.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished

RTUR:
	Inherits: ^Defense
	Inherits@IDISABLE: ^DisabledOverlay
	Inherits@AUTOTARGET: ^AutoTargetforGUN
    Inherits@EMPMechanic: ^EMPApplicableStructure
	-BodyOrientation:
	Selectable:
		Bounds: 1280, 1280
        DecorationBounds: 1450, 1450
	Valued:
		Cost: 1500
	Tooltip:
		Name: Railgun Turret
	Buildable:
        BuildDuration: 2100
        BuildDurationModifier: 100
		BuildPaletteOrder: 3
		Prerequisites: miss, ~player.gdib, ~techlevel.6
		Queue: Defense.GDI
		Description: Experimental base defense.\nThe armament damages in a line.\nRequires power to operate.\n\nStrong vs Tanks, Vehicles.\nWeak vs Infantry.
	Building:
	Health:
		HP: 60000
	Armor:
		Type: Heavy
	RevealsShroud:
		Range: 4c512
	WithBuildingBib:
		HasMinibib: true
	Turreted:
		TurnSpeed: 12
		InitialFacing: 496
		RealignDelay: -1
		RequiresCondition: !build-incomplete
	WithSpriteTurret:
		RequiresCondition: !build-incomplete
		Recoils: false
	Armament:
		Weapon: TurretRailgun
		LocalOffset: 1024,-32,224
		MuzzleSequence: muzzle
        PauseOnCondition: build-incomplete
	AttackTurreted:
		PauseOnCondition: build-incomplete || emp-affected-structure
	WithMuzzleOverlay:
	DetectCloaked:
        DetectionTypes: Stealth, AirStealth, Underground, Underwater
		Range: 3c768
		RequiresCondition: !lowpower && !build-incomplete && !emp-affected-structure
	RenderDetectionCircle:
	ReloadArmamentsBar:
		Armaments: primary
		Color: FFFF00
	Power:
		Amount: -100
		RequiresCondition: !build-incomplete && !emp-affected-structure
	ClassicFacingBodyOrientation:
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
    Sellable:
        RequiresCondition: !build-incomplete && !being-demolished && !emp-affected-structure
	RevealOnFire:
		ArmamentNames: primary
        RevealForRelationships: Ally, Neutral, Enemy
        RevealGeneratedShroud: false
        RequiresCondition: reveal-on
    GrantConditionOnPrerequisite@REVEALTOGGLE:
        Condition: reveal-on
        Prerequisites: ~global-unitreveal
	SpawnActorOnDeath@HUSK:
		Actor: RTUR.Husk
        OwnerType: Victim
        EffectiveOwnerFromOwner: true
        RequiresCondition: husks-enabled && !being-demolished
